!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="043dc4df-ec2b-4c27-962a-918ff33d0675",e._sentryDebugIdIdentifier="sentry-dbid-043dc4df-ec2b-4c27-962a-918ff33d0675")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"2dc6c61e76886309b3cd5c123cc0de71e3e4ba59"},(self.webpackChunkschema_diagram_vue=self.webpackChunkschema_diagram_vue||[]).push([[7935],{62323:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,o=void 0,o=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===n(o)?o:String(o)),r)}var a,o}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Table=t.Ref=t.Index=t.Field=t.Enum=t.Endpoint=void 0;var o=function(){function e(t){var n=t.name,r=t.unique,a=t.pk,o=t.type,u=t.columns;i(this,e),this.name=n,this.type=o,this.unique=r,this.pk=a,this.columns=u}return a(e,[{key:"toJSON",value:function(){return{name:this.name,type:this.type,unique:this.unique,pk:this.pk,columns:this.columns}}}]),e}();t.Index=o;var u=function(){function e(t){var n=t.name,r=t.type,a=t.not_null,o=t.increment,u=t.dbdefault,l=t.unique,c=t.pk,s=t.note;i(this,e),this.name=n,this.type=r,this.not_null=a,this.increment=o,this.dbdefault=u,this.unique=l,this.pk=c,this.note=s}return a(e,[{key:"toJSON",value:function(){return{name:this.name,type:this.type,not_null:this.not_null,increment:this.increment,dbdefault:this.dbdefault,unique:this.unique,pk:this.pk,note:this.note}}}]),e}();t.Field=u;var l=function(){function e(t){var n=t.name,r=t.schemaName,a=t.fields,o=t.indexes,u=t.note;i(this,e),this.name=n,this.schemaName=r,this.fields=a||[],this.indexes=o||[],this.note=u}return a(e,[{key:"toJSON",value:function(){var e,t;return{name:this.name,schemaName:this.schemaName,fields:null===(e=this.fields)||void 0===e?void 0:e.map((function(e){return e.toJSON()})),indexes:null===(t=this.indexes)||void 0===t?void 0:t.map((function(e){return e.toJSON()})),note:this.note}}}]),e}();t.Table=l;var c=function(){function e(t){var n=t.tableName,r=t.schemaName,a=t.fieldNames,o=t.relation;i(this,e),this.tableName=n,this.schemaName=r,this.fieldNames=a,this.relation=o}return a(e,[{key:"toJSON",value:function(){return{tableName:this.tableName,schemaName:this.schemaName,fieldNames:this.fieldNames,relation:this.relation}}}]),e}();t.Endpoint=c;var s=function(){function e(t){var n=t.name,r=t.endpoints,a=t.onDelete,o=t.onUpdate;i(this,e),this.name=n,this.endpoints=r||[],this.onDelete=a,this.onUpdate=o}return a(e,[{key:"toJSON",value:function(){return{name:this.name,onDelete:this.onDelete,onUpdate:this.onUpdate,endpoints:this.endpoints.map((function(e){return e.toJSON()}))}}}]),e}();t.Ref=s;var f=function(){function e(t){var n=t.name,r=t.schemaName,a=t.values;i(this,e),this.name=n,this.schemaName=r,this.values=a}return a(e,[{key:"toJSON",value:function(){return{name:this.name,schemaName:this.schemaName,values:this.values}}}]),e}();t.Enum=f},89756:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(36168)),a=o(n(90032));function o(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,o=void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(o)?o:String(o)),r)}var a,o}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(o,e);var t,n,i,r=c(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).errors=[],t}return t=o,(n=[{key:"syntaxError",value:function(e,t,n,i,r,o){this.errors.push(new a.default(n,i,r))}}])&&u(t.prototype,n),i&&u(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.default.error.ErrorListener);t.default=f},90032:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,o=void 0,o=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===n(o)?o:String(o)),r)}var a,o}function r(e){var t=l();return function(){var i,r=s(e);if(t){var o=s(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}(this,i)}}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){var t="function"==typeof Map?new Map:void 0;return o=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return u(e,arguments,s(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),c(i,e)},o(e)}function u(e,t,n){return u=l()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&c(r,n.prototype),r},u.apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(l,e);var t,n,o,u=r(l);function l(e,t,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i=u.call(this,n),Error.captureStackTrace&&Error.captureStackTrace(a(i),l),i.text=n,i.location={start:{line:e,column:t}},i}return t=l,n&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(o(Error));t.default=f},4950:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TABLE_CONSTRAINT_KIND=t.DATA_TYPE=t.CONSTRAINT_TYPE=t.COLUMN_CONSTRAINT_KIND=void 0;t.TABLE_CONSTRAINT_KIND={FIELD:"field",INDEX:"index",FK:"fk",UNIQUE:"unique",PK:"pk"};t.COLUMN_CONSTRAINT_KIND={NOT_NULL:"not_null",UNIQUE:"unique",PK:"pk",DEFAULT:"dbdefault",INCREMENT:"increment",INLINE_REF:"inline_ref",NOTE:"note"};t.DATA_TYPE={STRING:"string",NUMBER:"number",BOOLEAN:"boolean",EXPRESSION:"expression"};t.CONSTRAINT_TYPE={COLUMN:"column",STRING:"string",EXPRESSION:"expression"}},13778:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getOriginalText=function(e){var t=e.start.start,n=e.stop.stop;return(0,i.isNil)(t)||(0,i.isNil)(n)?void 0:e.start.getInputStream().getText(t,n)};var i=n(2543)},82483:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parse=function(e,t){var n=new i.default.InputStream(e),m=null,d=new v.default;switch(t){case"postgres":var y=new r.default(n),h=new i.default.CommonTokenStream(y),_=new a.default(h);if(_.buildParseTrees=!0,_.removeErrorListeners(),_.addErrorListener(d),m=_.root().accept(new o.default),d.errors.length)throw d.errors;break;case"mysql":var N=new u.default(n),b=new i.default.CommonTokenStream(N),T=new l.default(b);if(T.buildParseTrees=!0,T.removeErrorListeners(),T.addErrorListener(d),m=T.root().accept(new c.default),d.errors.length)throw d.errors;break;case"snowflake":var O=new s.default(n),k=new i.default.CommonTokenStream(O),g=new f.default(k);if(g.buildParseTrees=!0,g.removeErrorListeners(),g.addErrorListener(d),m=g.snowflake_file().accept(new p.default),d.errors.length)throw d.errors;break;default:throw new Error("Format not supported: ".concat(t))}return m};var i=m(n(36168)),r=m(n(18780)),a=m(n(88659)),o=m(n(79566)),u=m(n(58506)),l=m(n(11749)),c=m(n(56082)),s=m(n(23562)),f=m(n(28741)),p=m(n(90282)),v=m(n(89756));function m(e){return e&&e.__esModule?e:{default:e}}},56082:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=n(2543),o=(r=n(41935))&&r.__esModule?r:{default:r},u=n(62323),l=n(4950);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,u=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(u.push(i.value),u.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return u}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,h(i.key),i)}}function h(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var a=b(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var T="note",O="add_pk",k="add_fk",g="type",I=function(e){return{tableName:(0,a.last)(e),schemaName:e.length>1?e[e.length-2]:void 0}},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(o,e);var t,n,i,r=N(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).data={schemas:[],tables:[],refs:[],enums:[],tableGroups:[],aliases:[],project:{}},e}return t=o,(n=[{key:"findTable",value:function(e,t){var n=e||"public";return this.data.tables.find((function(e){return(e.schemaName||"public")===n&&e.name===t}))}},{key:"visitRoot",value:function(e){var t;return null===(t=e.sqlStatements())||void 0===t||t.accept(this),this.data}},{key:"visitSqlStatements",value:function(e){var t=this;e.sqlStatement().forEach((function(e){e.accept(t)}))}},{key:"visitSqlStatement",value:function(e){e.ddlStatement()&&e.ddlStatement().accept(this)}},{key:"visitDdlStatement",value:function(e){var t=this;if(e.createTable()){var n,i,r=e.createTable().accept(this);if(!r)return;var o=r.tableName,c=r.schemaName,f=r.definitions,m=r.options,d=v(f.reduce((function(e,t){if(t.kind===l.TABLE_CONSTRAINT_KIND.FIELD)e[0].push(t.value);else if(t.kind===l.TABLE_CONSTRAINT_KIND.INDEX)e[1].push(t.value);else if(t.kind===l.TABLE_CONSTRAINT_KIND.UNIQUE)e[1].push(t.value);else if(t.kind===l.TABLE_CONSTRAINT_KIND.FK)e[2].push(t.value);else if(t.kind===l.TABLE_CONSTRAINT_KIND.PK){var n=t.value;n.columns.length>1?e[1].push(t.value):e[3]=n}return e}),[[],[],[],null]),4),y=d[0],h=d[1],_=d[2],N=d[3],b=y.map((function(e){var n,i=e.field,r=e.inlineRefs;if("enum"===(null===(n=i.type.type_name)||void 0===n?void 0:n.toLowerCase())){var a=i.type.args.map((function(e){return{name:e.replace(/'|"|`/g,"").trim()}})),l=new u.Enum({name:"".concat(o,"_").concat(i.name,"_enum"),schemaName:c,values:a});i.type.type_name=l.name,i.type.schemaName=l.schemaName,t.data.enums.push(l)}return r.forEach((function(e){e.endpoints[0].tableName=o,e.endpoints[0].schemaName=c,e.endpoints[0].fieldNames=[i.name]})),r}));(n=this.data.refs).push.apply(n,p((0,a.flatten)(b))),(i=this.data.refs).push.apply(i,p(_.map((function(e){return e.endpoints[0].tableName=o,e.endpoints[0].schemaName=c,e}))));var T=m.reduce((function(e,t){return e[t.kind]=t.value,e}),{}),O=new u.Table(s({name:o,schemaName:c,fields:y.map((function(e){return e.field})),indexes:h},T));if(N){var k=O.fields.find((function(e){return e.name===N.columns[0].value}));k&&(k.pk=!0)}this.data.tables.push(O.toJSON())}else e.alterTable()?e.alterTable().accept(this):e.createIndex()&&e.createIndex().accept(this)}},{key:"visitCopyCreateTable",value:function(e){}},{key:"visitQueryCreateTable",value:function(e){var t,n=this,i=e.tableName().accept(this),r=I(i),a=r.tableName,o=r.schemaName;return e.createDefinitions()?{tableName:a,schemaName:o,definitions:e.createDefinitions().accept(this).filter((function(e){return null==e?void 0:e.kind})),options:(null===(t=e.tableOption())||void 0===t?void 0:t.map((function(e){return e.accept(n)})).filter((function(e){return null==e?void 0:e.kind})))||[]}:null}},{key:"visitColumnCreateTable",value:function(e){var t=this,n=e.tableName().accept(this),i=I(n);return{tableName:i.tableName,schemaName:i.schemaName,definitions:e.createDefinitions().accept(this).filter((function(e){return null==e?void 0:e.kind})),options:e.tableOption().map((function(e){return e.accept(t)})).filter((function(e){return null==e?void 0:e.kind}))}}},{key:"visitTableOptionComment",value:function(e){var t=e.STRING_LITERAL().getText();return{kind:T,value:{value:t.slice(1,t.length-1)}}}},{key:"visitTableName",value:function(e){return e.fullId().accept(this)}},{key:"visitFullId",value:function(e){var t=this,n=e.uid().map((function(e){return e.accept(t)}));if(e.DOT_ID()){var i=e.DOT_ID().getText();n.push(i.slice(1))}return n}},{key:"visitUid",value:function(e){if(e.simpleId())return e.simpleId().accept(this);var t=e.getChild(0).getText();return t.slice(1,t.length-1)}},{key:"visitSimpleId",value:function(e){return e.getChild(0).getText()}},{key:"visitCreateDefinitions",value:function(e){var t=this;return e.createDefinition().map((function(e){return e.accept(t)}))}},{key:"visitColumnDeclaration",value:function(e){var t=function(e){return{fieldName:(0,a.last)(e),tableName:e.length>1?e[e.length-2]:void 0,schemaName:e.length>2?e[e.length-3]:void 0}}(e.fullColumnName().accept(this)),n=t.fieldName,i=e.columnDefinition().accept(this),r=i.type,o=i.constraints,c=new u.Field(s({name:n,type:r},o));return{kind:l.TABLE_CONSTRAINT_KIND.FIELD,value:{field:c,inlineRefs:o.inlineRefs}}}},{key:"visitConstraintDeclaration",value:function(e){return e.tableConstraint().accept(this)}},{key:"visitIndexDeclaration",value:function(e){return e.indexColumnDefinition().accept(this)}},{key:"visitFullColumnName",value:function(e){var t=this,n=[];return e.uid()&&n.push(e.uid().accept(this)),n.push.apply(n,p(e.dottedId().map((function(e){return e.accept(t)})))),n}},{key:"visitDottedId",value:function(e){return e.DOT_ID()?e.DOT_ID().getText().slice(1):e.uid().accept(this)}},{key:"visitColumnDefinition",value:function(e){var t=this,n=e.dataType().accept(this),i={inlineRefs:[]};return e.columnConstraint().forEach((function(e){var n=e.accept(t);n&&(n.kind!==l.COLUMN_CONSTRAINT_KIND.INLINE_REF?i[n.kind]=n.value:i.inlineRefs.push(n.value))})),{type:n,constraints:i}}},{key:"visitStringDataType",value:function(e){var t=e.typeName.text;return e.lengthOneDimension()&&(t+=e.lengthOneDimension().getText()),{type_name:t,schemaName:null}}},{key:"visitNationalVaryingStringDataType",value:function(e){var t=e.typeName.text;return e.lengthOneDimension()&&(t+=e.lengthOneDimension().getText()),{type_name:t,schemaName:null}}},{key:"visitNationalStringDataType",value:function(e){var t=e.typeName.text;return e.lengthOneDimension()&&(t+=e.lengthOneDimension().getText()),{type_name:t,schemaName:null}}},{key:"visitDimensionDataType",value:function(e){var t=e.typeName.text;return e.lengthOneDimension()&&(t+=e.lengthOneDimension().getText()),e.lengthTwoDimension()&&(t+=e.lengthTwoDimension().getText()),e.lengthTwoOptionalDimension()&&(t+=e.lengthTwoOptionalDimension().getText()),{type_name:t,schemaName:null}}},{key:"visitSimpleDataType",value:function(e){return{type_name:e.typeName.text,schemaName:null}}},{key:"visitCollectionDataType",value:function(e){return e.SET()?{type_name:e.typeName.text+e.collectionOptions().getText(),schemaName:null}:{type_name:e.typeName.text,args:e.collectionOptions().accept(this),schemaName:null}}},{key:"visitCollectionOptions",value:function(e){return e.STRING_LITERAL().map((function(e){return e.getText()}))}},{key:"visitSpatialDataType",value:function(e){return{type_name:e.typeName.text,schemaName:null}}},{key:"visitLongVarcharDataType",value:function(e){return{type_name:e.typeName.text,schemaName:null}}},{key:"visitLongVarbinaryDataType",value:function(e){return{type_name:"".concat(e.LONG().getText()," ").concat(e.VARBINARY().getText()),schemaName:null}}},{key:"visitNullColumnConstraint",value:function(e){return e.nullNotnull().accept(this)}},{key:"visitNullNotnull",value:function(e){var t=!1;return e.NOT()&&(t=!0),{kind:l.COLUMN_CONSTRAINT_KIND.NOT_NULL,value:t}}},{key:"visitDefaultColumnConstraint",value:function(e){return{kind:l.COLUMN_CONSTRAINT_KIND.DEFAULT,value:e.defaultValue().accept(this)}}},{key:"visitAutoIncrementColumnConstraint",value:function(e){return e.AUTO_INCREMENT()?{kind:l.COLUMN_CONSTRAINT_KIND.INCREMENT,value:!0}:null}},{key:"visitPrimaryKeyColumnConstraint",value:function(e){return e.PRIMARY()?{kind:l.COLUMN_CONSTRAINT_KIND.PK,value:!0}:null}},{key:"visitUniqueKeyColumnConstraint",value:function(e){return{kind:l.COLUMN_CONSTRAINT_KIND.UNIQUE,value:!0}}},{key:"visitCommentColumnConstraint",value:function(e){var t=e.STRING_LITERAL().getText();return{kind:l.COLUMN_CONSTRAINT_KIND.NOTE,value:{value:t.slice(1,t.length-1)}}}},{key:"visitReferenceColumnConstraint",value:function(e){var t=e.referenceDefinition().accept(this);return{kind:l.COLUMN_CONSTRAINT_KIND.INLINE_REF,value:t}}},{key:"visitDefaultValue",value:function(e){var t;if(e.NULL_LITERAL())return{value:e.NULL_LITERAL().getText(),type:l.DATA_TYPE.BOOLEAN};if(e.expression())return{value:e.expression().getText(),type:l.DATA_TYPE.EXPRESSION};if(e.constant()){if(e.unaryOperator())return{value:e.getText(),type:l.DATA_TYPE.EXPRESSION};var n=e.constant().accept(this);return{value:n.value,type:n.type}}return null!==(t=e.currentTimestamp())&&void 0!==t&&t.length?{value:e.currentTimestamp()[0].getText(),type:l.DATA_TYPE.EXPRESSION}:{value:e.getText(),type:l.DATA_TYPE.EXPRESSION}}},{key:"visitConstant",value:function(e){if(e.stringLiteral()){var t=e.stringLiteral().getText();return{value:t.slice(1,t.length-1),type:l.DATA_TYPE.STRING}}return e.decimalLiteral()?e.getChildCount()>1?{value:e.getText(),type:l.DATA_TYPE.EXPRESSION}:{value:e.decimalLiteral().getText(),type:l.DATA_TYPE.NUMBER}:e.hexadecimalLiteral()?{value:e.hexadecimalLiteral().getText(),type:l.DATA_TYPE.NUMBER}:e.booleanLiteral()?{value:e.booleanLiteral().getText(),type:l.DATA_TYPE.BOOLEAN}:e.REAL_LITERAL()?{value:e.REAL_LITERAL().getText(),type:l.DATA_TYPE.NUMBER}:e.BIT_STRING()?{value:e.BIT_STRING().getText(),type:l.DATA_TYPE.STRING}:{value:e.getText(),type:l.DATA_TYPE.STRING}}},{key:"visitReferenceDefinition",value:function(e){var t,n=e.tableName().accept(this),i=I(n),r=i.tableName,a=i.schemaName;if(!e.indexColumnNames())return null;var o=(null===(t=e.referenceAction())||void 0===t?void 0:t.accept(this))||{},l=e.indexColumnNames().accept(this).map((function(e){return e.value})),c=new u.Endpoint({tableName:null,schemaName:null,fieldNames:null,relation:"*"}),s=new u.Endpoint({tableName:r,schemaName:a,fieldNames:l,relation:"1"});return new u.Ref({endpoints:[c,s],onUpdate:o.onUpdate,onDelete:o.onDelete})}},{key:"visitIndexColumnNames",value:function(e){var t=this;return e.indexColumnName().map((function(e){return e.accept(t)}))}},{key:"visitIndexColumnName",value:function(e){if(e.uid())return{type:l.CONSTRAINT_TYPE.COLUMN,value:e.uid().accept(this)};if(e.STRING_LITERAL()){var t=e.STRING_LITERAL().getText();return{type:l.CONSTRAINT_TYPE.STRING,value:t.slice(1,t.length-1)}}return{type:l.CONSTRAINT_TYPE.EXPRESSION,value:e.expression().getText()}}},{key:"visitReferenceAction",value:function(e){var t,n,i={};return i.onDelete=null===(t=e.onDelete)||void 0===t?void 0:t.accept(this),i.onUpdate=null===(n=e.onUpdate)||void 0===n?void 0:n.accept(this),i}},{key:"visitReferenceControlType",value:function(e){var t=p(Array(e.getChildCount()).keys()).reduce((function(t,n){return"".concat(t).concat(e.getChild(n).getText()," ")}),"");return t.slice(0,t.length-1)}},{key:"visitPrimaryKeyTableConstraint",value:function(e){var t,n,i,r,a=this,o=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),c=null===(i=e.indexType())||void 0===i?void 0:i.accept(this);if(null!==(r=e.indexOption())&&void 0!==r&&r.length){var s=e.indexOption().map((function(e){return e.accept(a)})).find((function(e){return(null==e?void 0:e.kind)===g}));s&&(c=s.value)}var f=e.indexColumnNames().accept(this);return{kind:l.TABLE_CONSTRAINT_KIND.PK,value:new u.Index({name:o,pk:!0,columns:f,type:c})}}},{key:"visitUniqueKeyTableConstraint",value:function(e){var t,n,i,r,a=this,o=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),c=null===(i=e.indexType())||void 0===i?void 0:i.accept(this);if(null!==(r=e.indexOption())&&void 0!==r&&r.length){var s=e.indexOption().map((function(e){return e.accept(a)})).find((function(e){return(null==e?void 0:e.kind)===g}));s&&(c=s.value)}var f=e.indexColumnNames().accept(this);return{kind:l.TABLE_CONSTRAINT_KIND.UNIQUE,value:new u.Index({name:o,unique:!0,columns:f,type:c})}}},{key:"visitForeignKeyTableConstraint",value:function(e){var t,n,i=e.referenceDefinition().accept(this);return i.name=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),i.endpoints[0].fieldNames=e.indexColumnNames().accept(this).map((function(e){return e.value})),{kind:l.TABLE_CONSTRAINT_KIND.FK,value:i}}},{key:"visitCheckTableConstraint",value:function(e){}},{key:"visitIndexType",value:function(e){return e.getChild(1).getText()}},{key:"visitIndexOption",value:function(e){return e.indexType()?{kind:g,value:e.indexType().accept(this)}:null}},{key:"visitSimpleIndexDeclaration",value:function(e){var t,n,i,r=this,a=null===(t=e.uid())||void 0===t?void 0:t.accept(this),o=null===(n=e.indexType())||void 0===n?void 0:n.accept(this);if(null!==(i=e.indexOption())&&void 0!==i&&i.length){var c=e.indexOption().map((function(e){return e.accept(r)})).find((function(e){return(null==e?void 0:e.kind)===g}));c&&(o=c.value)}var s=e.indexColumnNames().accept(this);return{kind:l.TABLE_CONSTRAINT_KIND.INDEX,value:new u.Index({name:a,columns:s,type:o})}}},{key:"visitSpecialIndexDeclaration",value:function(e){var t,n,i=this,r=null===(t=e.uid())||void 0===t?void 0:t.accept(this),a=null;if(null!==(n=e.indexOption())&&void 0!==n&&n.length){var o=e.indexOption().map((function(e){return e.accept(i)})).find((function(e){return(null==e?void 0:e.kind)===g}));o&&(a=o.value)}var c=e.indexColumnNames().accept(this);return{kind:l.TABLE_CONSTRAINT_KIND.INDEX,value:new u.Index({name:r,columns:c,type:a})}}},{key:"visitAlterTable",value:function(e){var t,n=this,i=e.tableName().accept(this),r=I(i),a=r.tableName,o=r.schemaName,u=this.findTable(o,a);u&&((null===(t=e.alterSpecification())||void 0===t?void 0:t.map((function(e){return e.accept(n)})).filter((function(e){return null==e?void 0:e.kind})))||[]).forEach((function(e){if(e.kind===O){var t=e.value;if(t.columns.length>1)return u.indexes.push(t);u.fields.find((function(e){return e.name===t.columns[0].value})).pk=!0}else if(e.kind===k){var i=e.value;i.endpoints[0].schemaName=o,i.endpoints[0].tableName=a,n.data.refs.push(i)}return null}))}},{key:"visitAlterByAddPrimaryKey",value:function(e){var t,n,i,r,a=this,o=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),l=null===(i=e.indexType())||void 0===i?void 0:i.accept(this);if(null!==(r=e.indexOption())&&void 0!==r&&r.length){var c=e.indexOption().map((function(e){return e.accept(a)})).find((function(e){return(null==e?void 0:e.kind)===g}));c&&(l=c.value)}var s=e.indexColumnNames().accept(this);return{kind:O,value:new u.Index({name:o,pk:!0,columns:s,type:l})}}},{key:"visitAlterByAddForeignKey",value:function(e){var t,n,i=e.referenceDefinition().accept(this);return i.name=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),i.endpoints[0].fieldNames=e.indexColumnNames().accept(this).map((function(e){return e.value})),{kind:k,value:i}}},{key:"visitCreateIndex",value:function(e){var t,n,i=this,r=e.tableName().accept(this),a=I(r),o=a.tableName,l=a.schemaName,c=this.findTable(l,o);if(c){var s=e.uid().accept(this),f=null===(t=e.indexType())||void 0===t?void 0:t.accept(this);if(null!==(n=e.indexOption())&&void 0!==n&&n.length){var p=e.indexOption().map((function(e){return e.accept(i)})).find((function(e){return(null==e?void 0:e.kind)===g}));p&&(f=p.value)}var v=e.indexColumnNames().accept(this),m=new u.Index({name:s,columns:v,unique:!!e.UNIQUE(),type:f});c.indexes.push(m)}}}])&&y(t.prototype,n),i&&y(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(o.default);t.default=E},7866:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var r;function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,o=void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(o)?o:String(o)),r)}var a,o}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var a=l(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.HandleLessLessGreaterGreater=function(){},t.checkLA=function(){},t.default=void 0,t.isTag=function(){},t.pushTag=function(){};var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(l,e);var t,n,i,r=u(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r.apply(this,arguments)}return t=l,n&&a(t.prototype,n),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(((r=n(36168))&&r.__esModule?r:{default:r}).default.Lexer);t.default=c},93503:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var r;function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,o=void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(o)?o:String(o)),r)}var a,o}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var a=l(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ParseRoutineBody=function(){},t.default=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(l,e);var t,n,i,r=u(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r.apply(this,arguments)}return t=l,n&&a(t.prototype,n),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(((r=n(36168))&&r.__esModule?r:{default:r}).default.Parser);t.default=c},79566:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=n(2543),o=(r=n(8385))&&r.__esModule?r:{default:r},u=n(62323),l=n(4950);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,u=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(u.push(i.value),u.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return u}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,h(i.key),i)}}function h(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var a=b(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var T="ref",O="table",k=function(e,t,n){var i=t||"public";return e.find((function(e){return(e.schemaName||"public")===i&&e.name===n}))},g=function(e){return e?e.replaceAll("''","'"):e},I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(o,e);var t,n,i,r=N(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).data={schemas:[],tables:[],refs:[],enums:[],tableGroups:[],aliases:[],project:{}},e}return t=o,(n=[{key:"visitRoot",value:function(e){return e.stmtblock().accept(this),this.data}},{key:"visitStmtblock",value:function(e){e.stmtmulti().accept(this)}},{key:"visitStmtmulti",value:function(e){var t=this;e.stmt().map((function(e){return e.accept(t)}))}},{key:"visitStmt",value:function(e){if(e.createstmt()){var t=e.createstmt().accept(this);return this.data.tables.push(t)}if(e.indexstmt()){var n=e.indexstmt().accept(this),i=n.pathName,r=i.tableName,a=i.schemaName,o=k(this.data.tables,a,r);if(!o)return;return o.indexes.push(n.index)}e.altertablestmt()?e.altertablestmt().accept(this):e.commentstmt()?e.commentstmt().accept(this):e.definestmt()&&e.definestmt().accept(this)}},{key:"visitCreatestmt",value:function(e){var t,n,i=e.qualified_name(0).accept(this),r=(0,a.last)(i),o=i.length>1?i[i.length-2]:void 0;if(e.opttableelementlist()){var c=v(e.opttableelementlist().accept(this).filter((function(e){return e})).reduce((function(e,t){return t.kind===l.TABLE_CONSTRAINT_KIND.FIELD?e[0].push(t.value):t.kind===l.TABLE_CONSTRAINT_KIND.INDEX?e[1].push(t.value):t.kind===l.TABLE_CONSTRAINT_KIND.FK?e[2].push(t.value):t.kind===l.TABLE_CONSTRAINT_KIND.UNIQUE&&e[1].push(t.value),e}),[[],[],[]]),3),s=c[0],f=c[1],m=c[2];return(t=this.data.refs).push.apply(t,p((0,a.flatten)(s.map((function(e){return e.inline_refs.map((function(t){return t.endpoints[0].tableName=r,t.endpoints[0].schemaName=o,t.endpoints[0].fieldNames=[e.field.name],t}))}))))),(n=this.data.refs).push.apply(n,p(m.map((function(e){return e.endpoints[0].tableName=r,e.endpoints[0].schemaName=o,e})))),new u.Table({name:r,schemaName:o,fields:s.map((function(e){return e.field})),indexes:f})}}},{key:"visitOpttableelementlist",value:function(e){return e.tableelementlist()?e.tableelementlist().accept(this):[]}},{key:"visitTableelementlist",value:function(e){var t=this;return e.tableelement().map((function(e){return e.accept(t)}))}},{key:"visitTableelement",value:function(e){return e.columnDef()?e.columnDef().accept(this):e.tableconstraint()?e.tableconstraint().accept(this):void 0}},{key:"visitTableconstraint",value:function(e){var t,n=null===(t=e.name())||void 0===t?void 0:t.accept(this),i=e.constraintelem().accept(this);if(i)return i.value.name=n,i}},{key:"visitConstraintelem",value:function(e){if(e.PRIMARY())return{kind:l.TABLE_CONSTRAINT_KIND.INDEX,value:new u.Index({pk:!0,columns:e.columnlist().accept(this)})};if(e.FOREIGN()){var t,n=e.qualified_name().accept(this),i=(0,a.last)(n),r=n.length>1?n[n.length-2]:void 0,o=e.columnlist().accept(this).map((function(e){return e.value})),c=null===(t=e.opt_column_list().accept(this))||void 0===t?void 0:t.map((function(e){return e.value})),s=e.key_actions().accept(this);return{kind:l.TABLE_CONSTRAINT_KIND.FK,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:o,relation:"*"},{tableName:i,schemaName:r,fieldNames:c,relation:"1"}],onDelete:s.onDelete,onUpdate:s.onUpdate}}}return e.UNIQUE()?{kind:l.TABLE_CONSTRAINT_KIND.UNIQUE,value:new u.Index({unique:!0,columns:e.columnlist().accept(this)})}:void 0}},{key:"visitOpt_column_list",value:function(e){var t;return null===(t=e.columnlist())||void 0===t?void 0:t.accept(this)}},{key:"visitColumnlist",value:function(e){var t=this;return e.columnElem().map((function(e){return e.accept(t)}))}},{key:"visitColumnElem",value:function(e){return{value:e.colid().accept(this),type:l.CONSTRAINT_TYPE.COLUMN}}},{key:"visitColumnDef",value:function(e){var t=e.colid().accept(this),n=e.typename().accept(this),i=e.colquallist().accept(this),r=new Set(["serial","smallserial","bigserial"]),a=n.type_name.toLowerCase();return r.has(a)&&(i.increment=!0),{kind:l.TABLE_CONSTRAINT_KIND.FIELD,value:{field:new u.Field(s({name:t,type:n},i)),inline_refs:i.inline_refs}}}},{key:"visitColquallist",value:function(e){var t=this,n={inline_refs:[]};return e.colconstraint().forEach((function(e){var i=e.accept(t);i&&(i.kind!==l.COLUMN_CONSTRAINT_KIND.INLINE_REF?n[i.kind]=i.value:n.inline_refs.push(i.value))})),n}},{key:"visitColconstraint",value:function(e){if(e.colconstraintelem())return e.colconstraintelem().accept(this)}},{key:"visitColconstraintelem",value:function(e){if(e.NULL_P()){var t=!1;return e.NOT()&&(t=!0),{kind:l.COLUMN_CONSTRAINT_KIND.NOT_NULL,value:t}}if(e.UNIQUE())return{kind:l.COLUMN_CONSTRAINT_KIND.UNIQUE,value:!0};if(e.PRIMARY())return{kind:l.COLUMN_CONSTRAINT_KIND.PK,value:!0};if(e.DEFAULT())return{kind:l.COLUMN_CONSTRAINT_KIND.DEFAULT,value:e.b_expr().accept(this)};if(e.IDENTITY_P())return{kind:l.COLUMN_CONSTRAINT_KIND.INCREMENT,value:!0};if(e.REFERENCES()){var n,i=e.qualified_name().accept(this),r=(0,a.last)(i),o=i.length>1?i[i.length-2]:void 0,u=null===(n=e.opt_column_list().accept(this))||void 0===n?void 0:n.map((function(e){return e.value})),c=e.key_actions().accept(this);return{kind:l.COLUMN_CONSTRAINT_KIND.INLINE_REF,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:null,relation:"*"},{tableName:r,schemaName:o,fieldNames:u,relation:"1"}],onDelete:c.onDelete,onUpdate:c.onUpdate}}}}},{key:"visitB_expr",value:function(e){return e.c_expr()?e.c_expr().accept(this):{value:e.getText(),type:l.DATA_TYPE.EXPRESSION}}},{key:"visitC_expr_expr",value:function(e){return e.aexprconst()?e.aexprconst().accept(this):e.a_expr()?{value:e.a_expr().getText(),type:l.DATA_TYPE.EXPRESSION}:{value:e.getText(),type:l.DATA_TYPE.EXPRESSION}}},{key:"visitC_expr_exists",value:function(e){return{value:e.getText(),type:l.DATA_TYPE.EXPRESSION}}},{key:"visitC_expr_case",value:function(e){return{value:e.getText(),type:l.DATA_TYPE.EXPRESSION}}},{key:"visitAexprconst",value:function(e){return e.sconst()&&1===e.getChildCount()?{value:e.sconst().accept(this),type:l.DATA_TYPE.STRING}:e.TRUE_P()||e.FALSE_P()||e.NULL_P()?{value:e.getText(),type:l.DATA_TYPE.BOOLEAN}:e.iconst()||e.fconst?{value:e.getText(),type:l.DATA_TYPE.NUMBER}:{value:e.getText(),type:l.DATA_TYPE.EXPRESSION}}},{key:"visitKey_actions",value:function(e){var t=null,n=null;return e.key_update()&&(n=e.key_update().accept(this)),e.key_delete()&&(t=e.key_delete().accept(this)),{onDelete:t,onUpdate:n}}},{key:"visitKey_update",value:function(e){return e.key_action().accept(this)}},{key:"visitKey_delete",value:function(e){return e.key_action().accept(this)}},{key:"visitKey_action",value:function(e){var t=p(Array(e.getChildCount()).keys()).reduce((function(t,n){return t+="".concat(e.getChild(n).getText()," ")}),"");return t.slice(0,t.length-1)}},{key:"visitQualified_name",value:function(e){var t=[e.colid().accept(this)];return e.indirection()&&t.push.apply(t,p(e.indirection().accept(this))),t}},{key:"visitColid",value:function(e){return e.getChild(0).accept(this)}},{key:"visitUnreserved_keyword",value:function(e){return e.getChild(0).getText()}},{key:"visitIdentifier",value:function(e){if(e.Identifier())return e.Identifier().getText();if(e.QuotedIdentifier()){var t=e.QuotedIdentifier().getText();return t.slice(1,t.length-1)}if(e.UnicodeQuotedIdentifier()){var n=e.UnicodeQuotedIdentifier().getText();return n.slice(1,n.length-1)}return e.plsql_unreserved_keyword()?e.plsql_unreserved_keyword().accept(this):e.getChild(0).getText()}},{key:"visitCol_name_keyword",value:function(e){return e.getChild(0).getText()}},{key:"visitPlsql_unreserved_keyword",value:function(e){return e.getChild(0).getText()}},{key:"visitIndirection",value:function(e){var t=this;return e.indirection_el().map((function(e){return e.accept(t)}))}},{key:"visitIndirection_el",value:function(e){if(e.attr_name())return e.attr_name().accept(this)}},{key:"visitAttr_name",value:function(e){return e.collabel().accept(this)}},{key:"visitCollabel",value:function(e){return e.getChild(0).accept(this)}},{key:"visitReserved_keyword",value:function(e){return e.getText()}},{key:"visitTypename",value:function(e){if(e.simpletypename()){var t="",n=e.simpletypename().accept(this);return e.opt_array_bounds()&&(t=e.opt_array_bounds().accept(this)),e.ARRAY()&&(t="[".concat(e.iconst()?e.iconst().accept(this):"","]")),{type_name:n.type+t,schemaName:n.schemaName}}}},{key:"visitSimpletypename",value:function(e){return e.generictype()?e.generictype().accept(this):e.character()?{type:e.character().accept(this),schemaName:null}:e.numeric()?{type:e.numeric().accept(this),schemaName:null}:e.constdatetime()?{type:e.constdatetime().accept(this),schemaName:null}:{type:e.getText(),schemaName:null}}},{key:"visitConstdatetime",value:function(e){return"".concat(e.getChild(0).getText()).concat(e.iconst()?"(".concat(e.iconst().accept(this),")"):"")}},{key:"visitNumeric",value:function(e){return e.getText()}},{key:"visitGenerictype",value:function(e){if(e.attrs()){var t=[e.getChild(0).getText()].concat(p(e.attrs().accept(this)));return{type:(0,a.last)(t),schemaName:t.length>1?t[t.length-2]:void 0}}return{type:(e.type_function_name()?e.type_function_name().accept(this):e.getText())+e.opt_type_modifiers().getText(),schemaName:null}}},{key:"visitCharacter",value:function(e){var t=e.character_c().accept(this);return e.getChildCount()>1&&(t+="(".concat(e.iconst().accept(this),")")),t}},{key:"visitCharacter_c",value:function(e){var t=p(Array(e.getChildCount()).keys()).reduce((function(t,n){return t+="".concat(e.getChild(n).getText()," ")}),"");return t.slice(0,t.length-1)}},{key:"visitType_function_name",value:function(e){return e.getChild(0).accept(this)}},{key:"visitType_func_name_keyword",value:function(e){return e.getText()}},{key:"visitOpt_array_bounds",value:function(e){return e.getText()}},{key:"visitIconst",value:function(e){return e.Integral().getText()}},{key:"visitIndexstmt",value:function(e){var t=e.relation_expr().accept(this),n=(0,a.last)(t),i=t.length>1?t[t.length-2]:void 0;if(e.opt_index_name())return{pathName:{tableName:n,schemaName:i},index:new u.Index({name:e.opt_index_name().accept(this),unique:e.opt_unique().accept(this),type:e.access_method_clause().accept(this),columns:e.index_params().accept(this)})}}},{key:"visitOpt_index_name",value:function(e){var t;return null===(t=e.name())||void 0===t?void 0:t.accept(this)}},{key:"visitName",value:function(e){return e.colid().accept(this)}},{key:"visitAccess_method_clause",value:function(e){if(e.name())return e.name().accept(this)}},{key:"visitRelation_expr",value:function(e){return e.qualified_name().accept(this)}},{key:"visitIndex_params",value:function(e){var t=this;return e.index_elem().map((function(e){return e.accept(t)})).filter((function(e){return!!e}))}},{key:"visitIndex_elem",value:function(e){return e.colid()?{value:e.colid().accept(this),type:l.CONSTRAINT_TYPE.STRING}:{value:e.getText(),type:l.CONSTRAINT_TYPE.EXPRESSION}}},{key:"visitOpt_unique",value:function(e){return!!e.UNIQUE()}},{key:"visitAltertablestmt",value:function(e){var t=this;if(e.TABLE()&&e.relation_expr()&&e.alter_table_cmds()){var n=e.relation_expr().accept(this),i=(0,a.last)(n),r=n.length>1?n[n.length-2]:void 0;return e.alter_table_cmds().accept(this).map((function(e){if(!e)return null;var n=null;switch(e.kind){case l.TABLE_CONSTRAINT_KIND.FK:n=T,e.value.endpoints[0].tableName=i,e.value.endpoints[0].schemaName=r,t.data.refs.push(e.value);break;case l.TABLE_CONSTRAINT_KIND.UNIQUE:case l.TABLE_CONSTRAINT_KIND.PK:case l.TABLE_CONSTRAINT_KIND.INDEX:if(0===e.value.columns.length)break;if(!e.value.pk&&!e.value.unique)break;n=e.kind;var a=k(t.data.tables,r,i);if(!a)break;if(1===e.value.columns.length&&(e.value.unique||e.value.pk)){var o=e.value.columns[0].value,c=a.fields.find((function(e){return e.name===o}));if(c){c[e.value.unique?"unique":"pk"]=!0;break}}var s=new u.Index({name:e.value.name,columns:e.value.columns,note:e.value.note,pk:e.value.pk,type:e.value.type,unique:e.value.unique});a.indexes.push(s)}return{kind:n,value:e.value}})).filter((function(e){return e}))}}},{key:"visitAlter_table_cmds",value:function(e){var t=this;return e.alter_table_cmd().map((function(e){return e.accept(t)}))}},{key:"visitAlter_table_cmd",value:function(e){if(e.tableconstraint())return e.tableconstraint().accept(this)}},{key:"visitCommentstmt",value:function(e){if(e.comment_text().accept(this),e.object_type_any_name()){var t=e.object_type_any_name().accept(this);if(!t)return;if(t===O){var n=e.any_name().accept(this),i=(0,a.last)(n),r=n.length>1?n[n.length-2]:void 0,o=k(this.data.tables,r,i);if(!o)return;var u=e.comment_text().accept(this);o.note={value:g(u)}}}if(e.COLUMN()){var l=e.any_name().accept(this),c=(0,a.last)(l),s=l.length>1?l[l.length-2]:void 0,f=l.length>2?l[l.length-3]:void 0,p=k(this.data.tables,f,s).fields.find((function(e){return e.name===c}));if(!p)return;var v=e.comment_text().accept(this);p.note={value:g(v)}}}},{key:"visitComment_text",value:function(e){return e.NULL_P()?null:e.sconst().accept(this)}},{key:"visitSconst",value:function(e){return e.anysconst().accept(this)}},{key:"visitAnysconst",value:function(e){var t=e.getChild(0).getText();return t.slice(1,t.length-1)}},{key:"visitObject_type_any_name",value:function(e){if(e.TABLE())return O}},{key:"visitAny_name",value:function(e){var t=[e.colid().accept(this)];return e.attrs()&&t.push.apply(t,p(e.attrs().accept(this))),t}},{key:"visitAttrs",value:function(e){var t=this;return e.attr_name().map((function(e){return e.accept(t)}))}},{key:"visitDefinestmt",value:function(e){if(e.TYPE_P()&&e.opt_enum_val_list()){var t=e.any_name(0).accept(this),n=(0,a.last)(t),i=t.length>1?t[t.length-2]:void 0,r=e.opt_enum_val_list().accept(this).map((function(e){return{name:e}}));if(!r)return;var o=new u.Enum({name:n,schemaName:i,values:r});this.data.enums.push(o.toJSON())}}},{key:"visitOpt_enum_val_list",value:function(e){var t;return null===(t=e.enum_val_list())||void 0===t?void 0:t.accept(this)}},{key:"visitEnum_val_list",value:function(e){var t=this;return e.sconst().map((function(e){return e.accept(t)}))}}])&&y(t.prototype,n),i&&y(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(o.default);t.default=I},90282:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=n(2543),o=(r=n(65743))&&r.__esModule?r:{default:r},u=n(62323),l=n(4950),c=n(13778);function s(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,u=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(u.push(i.value),u.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return u}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,o=void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(o)?o:String(o)),r)}var a,o}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var a=h(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var _=function(e){return(0,c.getOriginalText)(e).replace(/''/g,"'").slice(1,-1)},N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(o,e);var t,n,i,r=y(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).data={schemas:[],tables:[],refs:[],enums:[],tableGroups:[],aliases:[],project:{}},e}return t=o,(n=[{key:"visitSnowflake_file",value:function(e){var t;return null===(t=e.batch())||void 0===t||t.accept(this),this.data}},{key:"visitBatch",value:function(e){var t=this;e.sql_command().forEach((function(e){e.accept(t)}))}},{key:"visitSql_command",value:function(e){e.ddl_command()&&e.ddl_command().accept(this)}},{key:"visitDdl_command",value:function(e){e.alter_command()?e.alter_command().accept(this):e.create_command()&&e.create_command().accept(this)}},{key:"visitCreate_command",value:function(e){if(e.create_table()){var t=e.create_table().accept(this);this.data.tables.push(t)}else if(e.create_table_like()){var n=f(e.create_table_like().accept(this),4),i=n[0],r=n[1],a=n[2],o=n[3],l=this.data.tables.reduce((function(e,t){return t.name===o&&t.schemaName===a?t:e}),null);if(l){var c=new u.Table({name:r,schemaName:i,fields:l.fields});this.data.tables.push(c)}}}},{key:"visitCreate_database",value:function(e){var t=(0,c.getOriginalText)(e.object_name());this.data.schemas.push(t)}},{key:"visitCreate_table",value:function(e){var t,n,i,r=this,o=f(e.object_name().accept(this),3),c=(o[0],o[1]),p=o[2],v=e.create_table_clause().accept(this),m=v.definitions,d=v.tableNote,y=(null===(t=e.comment_clause())||void 0===t?void 0:t.accept(this))||d,h=f(m.reduce((function(e,t){if(t.kind===l.TABLE_CONSTRAINT_KIND.FIELD)e[0].push(t.value);else if(t.kind===l.TABLE_CONSTRAINT_KIND.UNIQUE)e[1].push(t.value);else if(t.kind===l.TABLE_CONSTRAINT_KIND.FK)e[2].push(t.value);else if(t.kind===l.TABLE_CONSTRAINT_KIND.PK){var n=t.value;n.columns.length>1?e[1].push(t.value):e[3]=n}return e}),[[],[],[],null]),4),_=h[0],N=h[1],b=h[2],T=h[3],O=_.map((function(e){var t,n=e.field,i=e.inlineRefs;if("enum"===(null===(t=n.type.type_name)||void 0===t?void 0:t.toLowerCase())){var a=n.type.args.map((function(e){return{name:e.replace(/'|"|`/g,"").trim()}})),o=new u.Enum({name:"".concat(p,"_").concat(n.name,"_enum"),schemaName:c,values:a});n.type.type_name=o.name,n.type.schemaName=o.schemaName,r.data.enums.push(o)}return i.forEach((function(e){e.endpoints[0].tableName=p,e.endpoints[0].schemaName=c,e.endpoints[0].fieldNames=[n.name]})),i}));(n=this.data.refs).push.apply(n,s((0,a.flatten)(O))),(i=this.data.refs).push.apply(i,s(b.map((function(e){return e.endpoints[0].tableName=p,e.endpoints[0].schemaName=c,e}))));var k=new u.Table({name:p,schemaName:c,fields:_.map((function(e){return e.field})),indexes:N,note:y});if(T){var g=k.fields.find((function(e){return e.name===T.columns[0].value}));g&&(g.pk=!0)}return k}},{key:"visitAlter_table",value:function(e){if(e.constraint_action()){var t=f(e.object_name()[0].accept(this),3),n=(t[0],t[1]),i=t[2],r=e.constraint_action().accept(this);if(r){var a,o=[],u=[],c=[];r.kind===l.TABLE_CONSTRAINT_KIND.FIELD?o.push(r.value):r.kind===l.TABLE_CONSTRAINT_KIND.UNIQUE?u.push(r.value):r.kind===l.TABLE_CONSTRAINT_KIND.FK&&c.push(r.value),(a=this.data.refs).push.apply(a,s(c.map((function(e){return e.endpoints[0].tableName=i,e.endpoints[0].schemaName=n,e}))));var p,v,m=this.data.tables.reduce((function(e,t){return t.name===i&&t.schemaName===n?t:e}),null);return m&&((p=m.fields).push.apply(p,o),(v=m.indexes).push.apply(v,u)),m}}return null}},{key:"visitCreate_table_like",value:function(e){var t=f(e.object_name()[0].accept(this),3),n=(t[0],t[1]),i=t[2],r=f(e.object_name()[1].accept(this),3);return r[0],[n,i,r[1],r[2]]}},{key:"visitObject_name",value:function(e){var t,n;return[null===(t=e.d)||void 0===t?void 0:t.accept(this),null===(n=e.s)||void 0===n?void 0:n.accept(this),e.o.accept(this)]}},{key:"visitId_",value:function(e){return e.DOUBLE_QUOTE_ID()?(0,c.getOriginalText)(e).slice(1,-1):(0,c.getOriginalText)(e)}},{key:"visitCreate_table_clause",value:function(e){var t,n=this;return{definitions:e.column_decl_item_list_paren().accept(this),tableNote:null===(t=e.comment_clause().map((function(e){return e.accept(n)})))||void 0===t?void 0:t[-1]}}},{key:"visitComment_clause",value:function(e){return _(e.string())}},{key:"visitColumn_decl_item_list_paren",value:function(e){return e.column_decl_item_list().accept(this)}},{key:"visitColumn_decl_item_list",value:function(e){var t=this;return e.column_decl_item().map((function(e){return e.accept(t)})).filter((function(e){return e}))}},{key:"visitColumn_decl_item",value:function(e){return e.full_col_decl()?{kind:l.TABLE_CONSTRAINT_KIND.FIELD,value:e.full_col_decl().accept(this)}:e.out_of_line_constraint()?e.out_of_line_constraint().accept(this):null}},{key:"visitFull_col_decl",value:function(e){var t=this,n=e.col_decl().accept(this),i=[];if(e.inline_constraint()){var r=e.inline_constraint().map((function(e){return e.accept(t)}));(0,a.isEmpty)(r)||r.forEach((function(e){e.kind===l.COLUMN_CONSTRAINT_KIND.UNIQUE?n.unique=!0:e.kind===l.COLUMN_CONSTRAINT_KIND.PK?n.pk=!0:e.kind===l.COLUMN_CONSTRAINT_KIND.FK&&i.push(e.value)}))}if(e.null_not_null()){var o=e.null_not_null().map((function(e){return e.accept(t)}));(0,a.isEmpty)(o)||o.forEach((function(e){e.kind===l.COLUMN_CONSTRAINT_KIND.NOT_NULL&&(n.not_null=e.value)}))}return e.default_value()&&e.default_value().map((function(e){return e.accept(t)})).forEach((function(e){e.kind===l.COLUMN_CONSTRAINT_KIND.DEFAULT?n.dbdefault=e.value:e.kind===l.COLUMN_CONSTRAINT_KIND.INCREMENT&&(n.increment=e.value)})),e.COMMENT()&&(n.note=_(e.string())),{field:n,inlineRefs:i}}},{key:"visitCol_decl",value:function(e){return new u.Field({name:e.column_name().accept(this),type:{type_name:(0,c.getOriginalText)(e.data_type()),schemaName:null}})}},{key:"visitColumn_name",value:function(e){var t=this;return e.id_().map((function(e){return e.accept(t)})).join(".")}},{key:"visitInline_constraint",value:function(e){if(e.UNIQUE())return{kind:l.COLUMN_CONSTRAINT_KIND.UNIQUE,value:!0};if(e.primary_key())return{kind:l.COLUMN_CONSTRAINT_KIND.PK,value:!0};if(e.foreign_key()&&e.column_name()){var t=f(e.object_name().accept(this),3),n=(t[0],t[1]),i=t[2],r=[e.column_name().accept(this)];return{kind:l.COLUMN_CONSTRAINT_KIND.FK,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:null,relation:"*"},{tableName:i,schemaName:n,fieldNames:r,relation:"1"}]}}}return{kind:null,value:null}}},{key:"visitOut_of_line_constraint",value:function(e){var t=this;if(e.UNIQUE()){var n,i=null===(n=e.id_())||void 0===n?void 0:n.accept(this),r=(0,a.flatten)(e.column_list_in_parentheses().map((function(e){return e.accept(t)}))),o=new u.Index({unique:!0,columns:r.map((function(e){return{value:e,type:l.CONSTRAINT_TYPE.COLUMN}}))});return{name:i,kind:l.TABLE_CONSTRAINT_KIND.UNIQUE,value:o}}if(e.primary_key()){var c,s=null===(c=e.id_())||void 0===c?void 0:c.accept(this),p=(0,a.flatten)(e.column_list_in_parentheses().map((function(e){return e.accept(t)}))),v=new u.Index({name:s,pk:!0,columns:p.map((function(e){return{value:e,type:l.CONSTRAINT_TYPE.COLUMN}}))});return{kind:l.TABLE_CONSTRAINT_KIND.PK,value:v}}if(e.foreign_key()&&2===e.column_list_in_parentheses().length){var m=f(e.object_name().accept(this),3),d=(m[0],m[1]),y=m[2],h=e.column_list_in_parentheses()[0].accept(this),_=e.column_list_in_parentheses()[1].accept(this);return{kind:l.TABLE_CONSTRAINT_KIND.FK,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:h,relation:"*"},{tableName:y,schemaName:d,fieldNames:_,relation:"1"}]}}}return null}},{key:"visitColumn_list_in_parentheses",value:function(e){return e.column_list().accept(this)}},{key:"visitColumn_list",value:function(e){var t=this;return e.column_name().map((function(e){return e.accept(t)}))}},{key:"visitNull_not_null",value:function(e){return{kind:l.COLUMN_CONSTRAINT_KIND.NOT_NULL,value:!!e.NOT()}}},{key:"visitDefault_value",value:function(e){return e.DEFAULT()?{kind:l.COLUMN_CONSTRAINT_KIND.DEFAULT,value:e.expr().accept(this)}:e.AUTOINCREMENT()||e.IDENTITY()?{kind:l.COLUMN_CONSTRAINT_KIND.INCREMENT,value:!0}:null}},{key:"visitExpr",value:function(e){return e.primitive_expression()?e.primitive_expression().accept(this):{value:(0,c.getOriginalText)(e),type:"expression"}}},{key:"visitPrimitive_expression",value:function(e){return e.NULL_()?{value:null,type:"boolean"}:e.literal()?e.literal().accept(this):{value:(0,c.getOriginalText)(e),type:"expression"}}},{key:"visitLiteral",value:function(e){return e.STRING()?{value:_(e),type:"string"}:e.DECIMAL()||e.REAL||e.FLOAT?{value:(0,c.getOriginalText)(e),type:"number"}:e.true_false()||e.NULL_()?{value:(0,c.getOriginalText)(e),type:"boolean"}:{value:(0,c.getOriginalText)(e),type:"expression"}}},{key:"visitConstraint_action",value:function(e){return e.ADD()?e.out_of_line_constraint().accept(this):null}}])&&m(t.prototype,n),i&&m(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(o.default);t.default=N}}]);
